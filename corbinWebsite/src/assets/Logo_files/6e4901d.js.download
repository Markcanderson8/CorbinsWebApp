(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1220:function(e,t,n){"use strict";var r=n(221),o={components:{Spinner:n.n(r).a},props:{bg:{type:String,default:"white"},isLoading:Boolean}},c=n(8),component=Object(c.a)(o,(function(){var e=this,t=e._self._c;return e.isLoading?t("div",{staticClass:"absolute w-full h-full inset-0 flex items-center justify-center bg-opacity-50 z-1000",class:"bg-".concat(e.bg)},[t("Spinner",{staticClass:"w-8 h-8 fill-current"})],1):e._e()}),[],!1,null,"af34215c",null);t.a=component.exports},1283:function(e,t,n){"use strict";n(165);var r=n(1229),o={components:{InfiniteLoading:n.n(r).a},props:{distance:{type:Number,default:200},identifier:{type:Number,default:+new Date}},data:function(){return{windowWidth:null}},computed:{isMobile:function(){return this.windowWidth<=767}},mounted:function(){this.setWindowWidth(),window.addEventListener("resize",this.setWindowWidth)},beforeDestroy:function(){window.removeEventListener("resize",this.setWindowWidth)},methods:{setWindowWidth:function(){this.windowWidth=window.innerWidth},onInfinite:function(e){this.$emit("infinite",e)}}},c=n(8),component=Object(c.a)(o,(function(){var e=this,t=e._self._c;return t("InfiniteLoading",{key:e.isMobile,attrs:{distance:e.distance,"force-use-infinite-wrapper":e.isMobile,identifier:e.identifier},on:{infinite:e.onInfinite}},[t("div",{attrs:{slot:"no-more"},slot:"no-more"}),e._v(" "),t("div",{attrs:{slot:"no-results"},slot:"no-results"})])}),[],!1,null,null,null);t.a=component.exports},1309:function(e,t,n){"use strict";(function(e){n(16),n(15),n(12),n(17),n(18);var r=n(1),o=n(3),c=(n(19),n(165),n(40),n(121)),l=n(1332),d=n(223),f=n(340),m=n(30),v=n(327),h=n(13),w=n(1220),_=n(71);n(137);function y(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}t.a={components:{Watermark:v.a,SpinnerLoader:w.a,Skeleton:c.a},props:{templateId:{type:String,default:null},iconId:{type:String,default:null},palette:{type:Object,default:null},logo:{type:Object,required:!0},shape:{type:String,default:null},updateKey:{type:Number,default:0},disablePreferenceMode:{type:Boolean,default:!0},mainPreview:{type:Boolean,default:!1},enableTextCasing:{type:Boolean,default:!1}},data:function(){return{logo_rendered:!1,render_time:null,logo_input:null,svgjsroot:null,finished_logo:null,background:null,unmounted:!1}},computed:k(k({},Object(m.e)(["editor","session","icons","history"])),Object(m.c)({getBinary:"fonts/getBinary",historyIndex:"history/index"})),watch:{updateKey:function(){this.svgjsroot&&this.logo_rendered&&this.refreshLogo()}},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.mainPreview&&h.a.$on(h.b.EditorRefreshLogo,e.refreshLogo),n=Object(d.a)(e.getSvgElement()),e.svgjsroot=n,t.next=5,e.createLogo();case 5:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.unmounted=!0,this.mainPreview&&h.a.$off(h.b.EditorRefreshLogo,this.refreshLogo)},methods:{getCanvasElement:function(){return this.$refs.canvas},getSvgElement:function(){return this.$refs.svg},sendRollbar:function(e){this.$sentry.captureException(e)},createLogo:function(){var e=arguments,t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.length>0&&void 0!==e[0]?e[0]:{},t.logo_rendered=!1,!t.editor.fonts||0!==t.editor.fonts.length){n.next=5;break}return n.next=5,t.$store.dispatch("editor/fetchFonts");case 5:return n.prev=5,n.next=8,t.invokeLogoDesignEngine(t.svgjsroot,r);case 8:n.next=15;break;case 10:n.prev=10,n.t0=n.catch(5),console.log("error creating logo ",n.t0),!t.unmounted&&t.svgjsroot&&t.getCanvasElement()&&t.sendRollbar(n.t0),t.$emit("failed");case 15:return n.prev=15,t.logo_rendered=!0,n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[5,10,15,18]])})))()},refreshLogo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.svgjsroot.first();t&&t.remove(),this.createLogo(e)},emitLogo:function(){if(this.logo_rendered&&this.logo){var e={logo:this.finished_logo,asset_data:{template:this.template}};this.$emit("logoselected",e)}},getFamilyByFontId:function(e){return this.editor.fonts.find((function(t){return t.variant_map.find((function(t){return t.id===e}))}))},getFontFromFamily:function(e,t){return e.variant_map.find((function(e){return e.id===t}))},getFont:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.getFamilyByFontId(e))){n.next=5;break}return n.abrupt("return",t.getFontFromFamily(r,e));case 5:return n.next=7,t.$api.get("/api/v3/assets/fonts/".concat(e),{params:{u:0}});case 7:return o=n.sent,data=o.data,n.abrupt("return",data);case 10:case"end":return n.stop()}}),n)})))()},getPalette:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("CUSTOM"!==e&&e){n.next=2;break}return n.abrupt("return",t.editor.logo_preset.palette_hex);case 2:if(!(r=t.editor.palettes.find((function(t){return t.id===e})))){n.next=5;break}return n.abrupt("return",r);case 5:return n.next=7,t.$api.get("/api/v3/assets/palettes/".concat(e));case 7:return o=n.sent,data=o.data,n.abrupt("return",data);case 10:case"end":return n.stop()}}),n)})))()},getIcon:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.icons.icons.find((function(t){return t.id===e})))){n.next=3;break}return n.abrupt("return",r);case 3:return n.abrupt("return",t.$store.dispatch("icons/getIcon",e));case 4:case"end":return n.stop()}}),n)})))()},getTemplate:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var template,r,data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(template=t.editor.templates.find((function(template){return template.id===e}))){n.next=7;break}return n.next=4,t.$api.get("/api/v3/assets/templates/".concat(e));case 4:return r=n.sent,data=r.data,n.abrupt("return",data);case 7:return n.abrupt("return",template);case 8:case"end":return n.stop()}}),n)})))()},invokeLogoDesignEngine:function(e){var t=arguments,n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o,c,d,m,v,h,w,y,k,x,O,j,P,L,template,R,S,F,$,B,E,C,M,I,W,T,D,N,z,J,A,G;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(v=t.length>1&&void 0!==t[1]?t[1]:{},(h=n.editor).logo_preset.wordmark_fonts){r.next=4;break}return r.abrupt("return");case 4:if(w=n.getCanvasElement(),r.prev=5,w.getContext("2d")){r.next=9;break}throw"Error: Canvas not mounted";case 9:r.next=16;break;case 11:return r.prev=11,r.t0=r.catch(5),console.log("canvas not mounted, cannot proceed"),n.$emit("failed"),r.abrupt("return");case 16:return y=h.logo_preset.wordmark_fonts,r.next=19,n.getFont(y);case 19:return k=r.sent,r.next=22,n.loadFontBinary(k);case 22:if(x=r.sent,O=h.logo_preset.palettes,null===(o=n.palette)||void 0===o){r.next=28;break}r.t1=o,r.next=31;break;case 28:return r.next=30,n.getPalette(O);case 30:r.t1=r.sent;case 31:return j=r.t1,P=JSON.parse(JSON.stringify(j)),n.background=P.background,L=null!==(c=n.templateId)&&void 0!==c?c:h.logo_preset.templates,r.next=37,n.getTemplate(L);case 37:if(template=r.sent,R={wordmark_fonts:[x],palettes:[P],templates:[template]},!(S=h.logo_preset.slogan_fonts)){r.next=50;break}return r.next=43,n.getFont(S);case 43:return F=r.sent,r.next=46,n.loadFontBinary(F);case 46:$=r.sent,R.slogan_fonts=[$],r.next=55;break;case 50:if(!n.session.slogan){r.next=55;break}return r.next=53,n.loadFontBinary(n.editor.fonts[0].variant_map[0]);case 53:B=r.sent,R.slogan_fonts=[B];case 55:if(E=null!==(d=n.iconId)&&void 0!==d?d:h.logo_preset.icons,C={ids:[]},!E){r.next=63;break}return r.next=60,n.getIcon(E);case 60:M=r.sent,R.icons=[M],C.ids.push(E);case 63:return I=new l.b([template],R),W={amount:1,brand:{wordmark:n.session.wordmark,slogan:n.session.slogan},presets:{templates:{ids:[L]},palettes:{ids:[P.id]},wordmark_fonts:{ids:[y]},slogan_fonts:{ids:[S]},icons:C},style:{enable_text_casing:n.enableTextCasing,disable_preference_mode:n.disablePreferenceMode,icon_orientation:n.disablePreferenceMode?h.icon_orientation:"default",icon_scale:h.icon_scale,slogan_scale:h.slogan_scale,slogan_alignment:n.disablePreferenceMode?h.slogan_alignment:"default",wordmark_alignment:n.disablePreferenceMode?h.wordmark_alignment:"default",slogan_multiline:n.disablePreferenceMode?h.slogan_multiline:"default",slogan_multicolor:n.disablePreferenceMode?h.slogan_multicolor:"default",wordmark_multiline:n.disablePreferenceMode?h.wordmark_multiline:"default",wordmark_multicolor:n.disablePreferenceMode?h.wordmark_multicolor:"default",shape_container:n.disablePreferenceMode?null!==(m=n.shape)&&void 0!==m?m:h.shape:"default",template_alignment:n.disablePreferenceMode?h.template_alignment:"default"},controls:{icon_page:1},inkscape:!1,svgjs:e,canvasdom:w,resources:I},r.next=67,f.logos.create(W);case 67:if(T=r.sent,n.finished_logo=T[0],!n.mainPreview){r.next=79;break}try{Object(_.a)(e)}catch(e){}if(D=n.session,N=D.wordmark,z=D.slogan,J=Object(_.g)(n.finished_logo,N,z),v.disableSetState||(n.$store.commit("history/add",J),n.$store.commit("editor/SET_LOGO",J)),!(A=n.svgjsroot.findOne("#tight-bounds"))){r.next=79;break}return G=A.svg(),r.next=79,n.$store.commit("editor/SET_TIGHT_BOUNDS",G);case 79:case"end":return r.stop()}}),r,null,[[5,11]])})))()},fetchFontBinary:function(t){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o,c,l,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t.id,c=t.cdn_url,r.prev=1,r.next=4,n.$api.get(c,{responseType:"arraybuffer"});case 4:return l=r.sent,d=e.from(l.data),n.$store.commit("fonts/addFontBinary",{id:o,buffer:d}),r.abrupt("return",k(k({},t),{},{file:d}));case 10:throw r.prev=10,r.t0=r.catch(1),n.$sentry.captureException(r.t0),r.t0;case 14:case"end":return r.stop()}}),r,null,[[1,10]])})))()},loadFontBinary:function(t){var n=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(o=n.getBinary(t.id))){r.next=5;break}return r.abrupt("return",k(k({},t),{},{file:e.from(o)}));case 5:return r.abrupt("return",n.fetchFontBinary(t));case 6:case"end":return r.stop()}}),r)})))()}}}}).call(this,n(26).Buffer)},1332:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n(342),o=n(343);function c(e,t){var n={};return n.assets=t,n.templates=e,n.loadAll=function(e){return this.assets},n.load=function(e){return this.templates},n}var l=function(){function e(t,n){Object(r.a)(this,e),this.templates=void 0,this.asssets=void 0,this.templates=t,this.assets=n}return Object(o.a)(e,[{key:"loadAll",value:function(e){return this.assets}},{key:"load",value:function(e){return this.templates}}]),e}()},1360:function(e,t,n){var content=n(1434);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(95).default)("0aa90bf4",content,!0,{sourceMap:!1})},1377:function(e,t,n){"use strict";var r=n(1309).a,o=(n(1433),n(8)),component=Object(o.a)(r,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"relative overflow-hidden rounded shadow-lg overlay",on:{click:function(t){return e.emitLogo()}}},[t("canvas",{ref:"canvas",attrs:{width:"1",height:"1"}}),e._v(" "),t("div",{staticClass:"logo-preview w-full"},[t("Transition",[e.mainPreview&&!e.logo_rendered?t("div",{staticClass:"absolute w-full h-full z-1000 p-auto",style:{background:e.background},on:{click:function(t){return e.emitLogo()}}},[t("SpinnerLoader",{attrs:{"is-loading":!0}})],1):e._e()]),e._v(" "),e.logo_rendered?e._e():t("Skeleton",{staticClass:"w-full",style:{"aspect-ratio":"8 / 5"}}),e._v(" "),e.logo_rendered?t("Watermark",{staticClass:"w-full h-full",attrs:{background:e.background}}):e._e(),e._v(" "),t("svg",{ref:"svg",class:e.logo_rendered?"":"absolute invisible",attrs:{xmlns:"http://www.w3.org/2000/svg",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:svgjs":"http://svgjs.com/svgjs",viewBox:"0 0 640 400"}})],1)])}),[],!1,null,null,null);t.a=component.exports},1433:function(e,t,n){"use strict";n(1360)},1434:function(e,t,n){var r=n(94)((function(i){return i[1]}));r.push([e.i,".logo-preview svg{width:100%;height:auto}.v-enter-active,.v-leave-active{transition:opacity .1s ease}.v-enter-from,.v-leave-to{opacity:0}.preview-svg svg{border-radius:.25rem;width:91.666667%}.logo-element-hover-target{cursor:pointer;stroke-width:2;fill:transparent}.overlay:hover .logo-element-hover-target{--text-opacity:1;color:#d2d6dc;color:rgba(210,214,220,var(--text-opacity));stroke:currentColor;opacity:.25}.logo-element-hover-target:hover{color:var(--color-enterprise-primary,#1890ff)!important;stroke:currentColor!important;opacity:1!important}",""]),r.locals={},e.exports=r}}]);
//# sourceMappingURL=6e4901d.js.map